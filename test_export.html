<!DOCTYPE html>
<html>
<head>
    <title>Test Export/Import</title>
</head>
<body>
    <h2>Test Export/Import Functionality</h2>
    
    <button onclick="testExport()">Test Export</button>
    <input type="file" id="testImport" accept=".csv" onchange="testImport(this)">
    
    <div id="results"></div>
    
    <script>
    async function testExport() {
        try {
            const response = await fetch('api/backup.php?action=export');
            if (response.ok) {
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'test_export.csv';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                document.getElementById('results').innerHTML = '✅ Export successful!';
            } else {
                document.getElementById('results').innerHTML = '❌ Export failed!';
            }
        } catch (error) {
            document.getElementById('results').innerHTML = '❌ Export error: ' + error.message;
        }
    }
    
    async function testImport(input) {
        const file = input.files[0];
        if (!file) return;
        
        try {
            const formData = new FormData();
            formData.append('file', file);
            
            const response = await fetch('api/backup.php?action=import', {
                method: 'POST',
                body: formData
            });
            
            const result = await response.json();
            
            if (result.success) {
                document.getElementById('results').innerHTML = '✅ Import successful! Imported ' + result.data.imported_count + ' records.';
            } else {
                document.getElementById('results').innerHTML = '❌ Import failed: ' + result.message;
            }
        } catch (error) {
            document.getElementById('results').innerHTML = '❌ Import error: ' + error.message;
        }
    }
    </script>
</body>
</html>
